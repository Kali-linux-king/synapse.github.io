// ========================
//  Tilt Effect Core
// ========================

/// Base tilt effect
/// @param {Number} $intensity - Tilt intensity (degrees)
/// @param {Number} $perspective - 3D perspective (px)
@mixin tilt-effect($intensity: 8deg, $perspective: 1000px) {
  transform-style: preserve-3d;
  transform: perspective($perspective);
  transition: transform 0.5s cubic-bezier(0.03, 0.98, 0.52, 0.99),
              box-shadow 0.5s ease;
  
  &:hover {
    transform: perspective($perspective) 
              rotateX(var(--tilt-x, 0deg)) 
              rotateY(var(--tilt-y, 0deg)) 
              scale(1.03);
  }
}

/// Glare effect for tilt
/// @param {Number} $opacity - Maximum glare opacity
@mixin tilt-glare($opacity: 0.2) {
  position: relative;
  overflow: hidden;
  
  &::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(
      135deg, 
      rgba(255, 255, 255, 0) 0%, 
      rgba(255, 255, 255, $opacity) 50%, 
      rgba(255, 255, 255, 0) 100%
    );
    transform: translate(-100%, -100%) rotate(25deg);
    transition: transform 0.6s cubic-bezier(0.23, 1, 0.32, 1);
    pointer-events: none;
    z-index: 10;
  }
  
  &:hover::before {
    transform: translate(100%, 100%) rotate(25deg);
  }
}

/// Depth effect with shadow
/// @param {Number} $depth - Shadow depth (px)
@mixin tilt-depth($depth: 20px) {
  box-shadow: 0 0 0 rgba(0, 0, 0, 0);
  transition: box-shadow 0.5s ease;
  
  &:hover {
    box-shadow: 
      calc(var(--tilt-y, 0deg) / 1deg * #{$depth / 20}) 
      calc(var(--tilt-x, 0deg) / 1deg * #{$depth / 20}) 
      $depth 
      rgba(0, 0, 0, 0.15);
  }
}

// ========================
//  Preconfigured Effects
// ========================

/// Card tilt effect
@mixin tilt-card {
  @include tilt-effect(10deg, 1200px);
  @include tilt-glare(0.15);
  @include tilt-depth(15px);
  
  // Performance optimizations
  backface-visibility: hidden;
  will-change: transform, box-shadow;
  
  // Accessibility
  @media (prefers-reduced-motion: reduce) {
    transform: none !important;
    
    &:hover {
      transform: none !important;
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1) !important;
    }
    
    &::before {
      display: none !important;
    }
  }
}

/// Subtle tilt for UI elements
@mixin tilt-ui {
  @include tilt-effect(5deg, 2000px);
  transition-duration: 0.3s;
  
  &:hover {
    transform: perspective(2000px) 
              rotateX(var(--tilt-x, 0deg)) 
              rotateY(var(--tilt-y, 0deg)) 
              scale(1.01);
  }
  
  @media (prefers-reduced-motion: reduce) {
    transform: none !important;
  }
}

/// Extreme tilt for hero elements
@mixin tilt-hero {
  @include tilt-effect(15deg, 800px);
  @include tilt-glare(0.3);
  @include tilt-depth(30px);
  
  &:hover {
    transform: perspective(800px) 
              rotateX(var(--tilt-x, 0deg)) 
              rotateY(var(--tilt-y, 0deg)) 
              scale(1.05);
  }
}

// ========================
//  JavaScript Integration
// ========================

[data-tilt] {
  @include tilt-card;
}

.tilt-enabled {
  @include tilt-ui;
  
  &--hero {
    @include tilt-hero;
  }
  
  &--none {
    transform: none !important;
  }
}

// ========================
//  Performance & Mobile
// ========================

@media (hover: none) {
  [data-tilt], 
  .tilt-enabled {
    transform: none !important;
    
    &:hover {
      transform: none !important;
      box-shadow: none !important;
    }
    
    &::before {
      display: none !important;
    }
  }
}

.tilt-wrapper {
  perspective: 1000px;
  transform-style: preserve-3d;
  
  > * {
    transition: transform 0.5s ease;
  }
}

// ========================
//  Custom Properties
// ========================

:root {
  --tilt-x: 0deg;
  --tilt-y: 0deg;
  --tilt-intensity: 8;
  --tilt-perspective: 1000;
}